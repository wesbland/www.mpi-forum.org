<HTML>
<HEAD>
<!-- This file was generated by tohtml from chap-topol/topol.tex -->
<!-- with the command
tohtml erif"> MPI-2.0</font>
-->
<TITLE>Low-Level Topology Functions</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<HR><H2><A NAME="Node176">169. Low-Level Topology Functions</a></H2>
<A HREF="node175.htm#Node175"><IMG WIDTH=16 HEIGHT=16 SRC="previous.gif"></A><A HREF="node168.htm#Node168"><IMG WIDTH=16 HEIGHT=16 SRC="up.gif"></A><A HREF="node177.htm#Node177"><IMG WIDTH=16 HEIGHT=16 SRC="next.gif"></A><BR>
<b>Up: </b><A HREF="node168.htm#Node168"> Topology Constructors</a>
<b>Next: </b><A HREF="node177.htm#Node177"> An Application Example</a>
<b>Previous: </b><A HREF="node175.htm#Node175"> Partitioning of Cartesian structures</a>
<P>
  
The two additional functions introduced in this section can be used to  
implement all other topology functions. In general they will not be  
called by the user directly, unless he or she is creating additional  
virtual topology capability other than that provided by <font face="sans-serif"> MPI</font>.  
<P> 
<TABLE><TR><TD COLSPAN=2>MPI_CART_MAP(comm, ndims, dims, periods, newrank)</TD></TR>  
<TR><TD> IN  comm</TD><TD> input communicator (handle)</TD></TR>  
<TR><TD> IN  ndims</TD><TD> number of dimensions of Cartesian structure (integer)</TD></TR>  
<TR><TD> IN  dims</TD><TD> integer array of size <tt> ndims</tt> specifying the number of processes in each coordinate direction </TD></TR>  
<TR><TD> IN   periods</TD><TD> logical array of size <tt> ndims</tt> specifying the periodicity specification in each coordinate direction</TD></TR>  
<TR><TD> OUT  newrank</TD><TD> reordered rank of the calling process; <font face="sans-serif">  MPI_UNDEFINED</font> if calling process does not belong to grid (integer)</TD></TR>  
</TABLE>  
<P> 
 <tt> int MPI_Cart_map(MPI_Comm comm, int ndims, int *dims, int *periods, int *newrank) <BR></tt>  
<P> 
 <tt> MPI_CART_MAP(COMM, NDIMS, DIMS, PERIODS, NEWRANK, IERROR)<BR> INTEGER COMM, NDIMS, DIMS(*), NEWRANK, IERROR <BR>LOGICAL PERIODS(*) <BR></tt>  
 <font color="red">{<font color="black"> int MPI::Cartcomm::Map(int ndims, const int dims[], const bool periods[]) const <font color="red"><em> (binding deprecated, see Section <a href="node328.htm#Node328">Deprecated since <font face="sans-serif"> MPI-2.2</font> 
</a>)</em> }<font color="black"><BR>  
  
<font face="sans-serif"> MPI_CART_MAP</font>  
computes an ``optimal'' placement for the calling process on the  
physical machine.  A possible implementation of this function is to always  
return the rank of the calling process, that is, not to perform any reordering.  
<P> 
 
<BR> 
<em> Advice  
        to implementors.</em>  
<P> 
The function <font face="sans-serif"> MPI_CART_CREATE(comm, ndims, dims,  
periods, reorder, comm_cart)</font>, with <tt> reorder = true</tt> can be implemented by  
calling  
<font face="sans-serif"> MPI_CART_MAP(comm, ndims, dims, periods, newrank)</font>, then calling  
<BR>  
<font face="sans-serif"> MPI_COMM_SPLIT(comm, color, key, comm_cart)</font>, with  
<tt> color = 0</tt> if <tt> newrank <IMG WIDTH=7 HEIGHT=10 SRC="img119.gif">
  
<BR>  
MPI_UNDEFINED</tt>, <tt> color = MPI_UNDEFINED</tt> otherwise,  
and <tt> key = newrank</tt>.  
<P> 
The function <font face="sans-serif"> MPI_CART_SUB(comm, remain_dims, comm_new)</font> can be  
implemented by a call to <font face="sans-serif"> MPI_COMM_SPLIT(comm, color, key, comm_new)</font>,  
using a single number encoding of the lost dimensions as <tt> color</tt> and a  
single number encoding of the preserved dimensions as <tt> key</tt>.  
<P> 
All other Cartesian topology functions can be implemented locally, using  
the topology information that is cached with the communicator.  
 (<em> End of advice to implementors.</em>) <BR> 
The corresponding new function for general graph structures is as follows.  
<P> 
<TABLE><TR><TD COLSPAN=2>MPI_GRAPH_MAP(comm, nnodes, index, edges, newrank)</TD></TR>  
<TR><TD> IN  comm</TD><TD> input communicator (handle)</TD></TR>  
<TR><TD> IN  nnodes</TD><TD> number of graph nodes (integer)</TD></TR>  
<TR><TD> IN  index</TD><TD>integer array specifying the graph structure, see <BR><font face="sans-serif"> MPI_GRAPH_CREATE</font></TD></TR>  
<TR><TD> IN  edges</TD><TD>integer array specifying the graph structure</TD></TR>  
<TR><TD> OUT  newrank</TD><TD> reordered rank of the calling process; <font face="sans-serif">  MPI_UNDEFINED</font> if the calling process does not belong to graph (integer)</TD></TR>  
</TABLE>  
<P> 
 <tt> int MPI_Graph_map(MPI_Comm comm, int nnodes, int *index, int *edges, int *newrank) <BR></tt>  
<P> 
 <tt> MPI_GRAPH_MAP(COMM, NNODES, INDEX, EDGES, NEWRANK, IERROR)<BR> INTEGER COMM, NNODES, INDEX(*), EDGES(*), NEWRANK, IERROR <BR></tt>  
 <font color="red">{<font color="black"> int MPI::Graphcomm::Map(int nnodes, const int index[], const int edges[]) const <font color="red"><em> (binding deprecated, see Section <a href="node328.htm#Node328">Deprecated since <font face="sans-serif"> MPI-2.2</font> 
</a>)</em> }<font color="black"><BR>  
  
 
<BR> 
<em> Advice  
        to implementors.</em>  
<P> 
The function <font face="sans-serif"> MPI_GRAPH_CREATE(comm, nnodes, index, edges,  
reorder, comm_graph)</font>,  
with <tt> reorder = true</tt> can be implemented by calling  
<font face="sans-serif"> MPI_GRAPH_MAP(comm, nnodes, index, edges, newrank)</font>,  
then calling  
<BR>  
<font face="sans-serif"> MPI_COMM_SPLIT(comm, color, key, comm_graph)</font>, with <tt> color = 0</tt>  
if <tt> newrank <IMG WIDTH=7 HEIGHT=10 SRC="img120.gif">
  
<BR>  
MPI_UNDEFINED</tt>, <tt> color = MPI_UNDEFINED</tt>  
otherwise, and <tt> key = newrank</tt>.  
<P> 
All other graph topology functions can be implemented locally, using the  
topology information that is cached with the communicator.  
 (<em> End of advice to implementors.</em>) <BR> 
  

<P>
<HR>
<A HREF="node175.htm#Node175"><IMG WIDTH=16 HEIGHT=16 SRC="previous.gif"></A><A HREF="node168.htm#Node168"><IMG WIDTH=16 HEIGHT=16 SRC="up.gif"></A><A HREF="node177.htm#Node177"><IMG WIDTH=16 HEIGHT=16 SRC="next.gif"></A><BR>
<b>Up: </b><A HREF="node168.htm#Node168"> Topology Constructors</a>
<b>Next: </b><A HREF="node177.htm#Node177"> An Application Example</a>
<b>Previous: </b><A HREF="node175.htm#Node175"> Partitioning of Cartesian structures</a>
<P>
<HR>
Return to <A HREF="node434.htm">MPI-2.2 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-2.2 of September 4, 2009<BR>
HTML Generated on September 10, 2009
</FONT>
</BODY>
</HTML>
