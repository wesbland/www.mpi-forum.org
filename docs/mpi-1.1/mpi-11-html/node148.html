<HTML>
<!-- This file was generated by tohtml from inquiry.tex -->
<TITLE>Error handling</TITLE>
<BODY BGCOLOR="#FFFFFF">
<HR><H1><A NAME="Node148">7.2. Error handling</a></H1>
<A HREF="node143.html#Node147"><IMG SRC="previous.gif"></A><A HREF="node141.html#Node141"><IMG SRC="up.gif"></A><A HREF="node149.html#Node149"><IMG SRC="next.gif"></A><BR>
<b>Up: </b><A HREF="node141.html#Node141"> MPI Environmental Management</a>
<b>Next: </b><A HREF="node149.html#Node149"> Error codes and classes</a>
<b>Previous: </b><A HREF="node143.html#Node147"> Clock synchronization</a>
<P>
  
<P> 
An  MPI implementation cannot or may choose not to handle some errors  
that occur during  MPI calls.  These can include errors that generate  
exceptions or traps, such as floating point errors or access  
violations.  
The set of errors that are handled by  MPI is implementation-dependent.  
Each such error generates an <b> MPI exception</b>.  
<P> 
  
The above text takes precedence over any text on error handling within this  
document.  Specifically, text that states that errors <em> will</em> be handled  
should be read as <em> may</em> be handled.  
  
<P> 
A user can associate an error handler with a communicator.  The  
specified error handling routine will be used for any  MPI exception  
that occurs during a call to  MPI for a communication with this communicator.  
 MPI calls that are not related to any communicator are considered to  
be attached to the communicator  MPI_COMM_WORLD.  
The attachment of error handlers to communicators is purely local:  
different processes may attach different error handlers  
to the same communicator.  
<P> 
A newly created communicator inherits the error  
handler that is associated with the ``parent'' communicator.  
In particular, the user can specify a ``global'' error handler for  
all communicators by  
associating this handler with the communicator  MPI_COMM_WORLD  
immediately after initialization.  
<P> 
Several predefined error handlers are available in  MPI:  
<dl> 
 
<dt> 
<b>{</b> MPI_ERRORS_ARE_FATAL}</b><dd> 
The handler, when called, causes the  
program to abort on all executing processes.  This has the same effect as if  
 MPI_ABORT was called by the process that invoked the handler.  
 
<dt> 
<b>{</b> MPI_ERRORS_RETURN}</b><dd> 
The handler has no effect   
   
other than  
returning the error code to the user.  
  
</dl> 
<BR> 
Implementations may provide additional predefined error handlers and  
programmers can code their own error handlers.  
<P> 
The error handler  
 MPI_ERRORS_ARE_FATAL is associated by default  
with  MPI_COMM_WORLDafter initialization.  Thus, if the user chooses not to control error handling,  
every error that  MPI handles is treated as fatal.  
Since (almost) all  MPI calls return an error code, a user may choose to handle  
errors in its main code, by testing the return code of  MPI calls and  
executing a  
suitable recovery code when the call was not successful.  In this case, the  
error handler  MPI_ERRORS_RETURN will be used.   Usually it is more  
convenient and more efficient not to test for errors after each  MPI call, and  
have such error handled by a non trivial  MPI error handler.  
<P> 
After an error is detected, the state of  MPI is undefined.  That is, using  
a user-defined error handler, or  MPI_ERRORS_RETURN, does <em> not</em>  
necessarily  
allow the user to continue to use  MPI after an error is detected.  The purpose  
of these error handlers is to allow a user to issue user-defined error messages  
and to take actions unrelated to  MPI (such as flushing I/O buffers) before a  
program exits.  
An  MPI implementation is free to allow  MPI to continue after  
an error but is not required to do so.  
<P> 
 
<BR> 
[]<em> Advice  
 to implementors.</em>  
<P> 
A good quality implementation will, to the greatest possible, extent,  
circumscribe the impact of an error, so that normal processing can  
continue after an error handler was invoked.  The implementation  
documentation will  
provide information on the possible effect of each class of errors.  
 (<em> End of advice to implementors.</em>) <BR> 
An  MPI error handler is an opaque object, which is accessed by a handle.  
 MPI calls are provided to create new error handlers, to associate error  
handlers with communicators, and to test which error handler is associated with  
a communicator.  
<P> 
    
      
      
      
      
     MPI_ERRHANDLER_CREATE( function, errhandler )  
     
<BR> 
[  IN   function] user defined error handling procedure  
 
<BR> 
[  OUT   errhandler] MPI error handler (handle)  
<BR> 
  
<P> 
 <tt> int MPI_Errhandler_create(MPI_Handler_function *function, MPI_Errhandler *errhandler) <BR></tt>  
<P> 
 <tt> MPI_ERRHANDLER_CREATE(FUNCTION, HANDLER, IERROR)<BR> EXTERNAL FUNCTION <BR>INTEGER ERRHANDLER, IERROR <BR></tt>  
Register the user routine  function for use as an  MPI  
exception handler.  Returns in  errhandler a handle to the registered  
exception handler.  
<P> 
  
In the C language,   
  
the user routine should be a C function of type  MPI_Handler_function,  
which is defined as:  
<P> 
<BR> 
<pre><tt>typedef void (MPI_Handler_function)(MPI_Comm *, int *, ...); 
</tt></pre> 
The first argument is the communicator in use.  
  
The second is  
the error code to be returned by the  MPI routine that raised the error.  
If the routine would have returned  MPI_ERR_IN_STATUS, it is  
the error code returned in the status for the request that caused the  
error handler to be invoked.  
  
The remaining arguments are ``<tt>stdargs</tt>'' arguments  
whose number and meaning is implementation-dependent.  An implementation  
should clearly document these arguments.  
Addresses are used so that the handler may be written in Fortran.  
<P> 
 
<BR> 
[]<em> Rationale.</em>  
<P> 
The variable argument list is provided because it provides an  
ANSI-standard hook for providing additional information to the error  
handler; without this hook, ANSI C prohibits additional arguments.  
 (<em> End of rationale.</em>) <BR> 
    
      
      
      
      
     MPI_ERRHANDLER_SET( comm, errhandler )  
     
<BR> 
[  IN   comm] communicator to set the error handler for (handle)  
 
<BR> 
[  IN   errhandler] new MPI error handler for communicator (handle)  
<BR> 
  
<P> 
 <tt> int MPI_Errhandler_set(MPI_Comm comm, MPI_Errhandler errhandler) <BR></tt>  
<P> 
 <tt> MPI_ERRHANDLER_SET(COMM, ERRHANDLER, IERROR)<BR> INTEGER COMM, ERRHANDLER, IERROR <BR></tt>  
<P> 
Associates the new error handler  errorhandler  
with communicator  comm at the calling process.  Note that an  
error handler is always associated with the communicator.  
<P> 
    
      
      
      
      
     MPI_ERRHANDLER_GET( comm, errhandler )  
     
<BR> 
[  IN   comm] communicator to get the error handler from (handle)  
 
<BR> 
[  OUT   errhandler] MPI error handler  
currently associated with communicator (handle)  
<BR> 
  
<P> 
 <tt> int MPI_Errhandler_get(MPI_Comm comm, MPI_Errhandler *errhandler) <BR></tt>  
<P> 
 <tt> MPI_ERRHANDLER_GET(COMM, ERRHANDLER, IERROR)<BR> INTEGER COMM, ERRHANDLER, IERROR <BR></tt>  
<P> 
Returns in  errhandler (a handle to) the error handler that is  
currently  
associated with communicator  comm.  
<P> 
Example:  
A library function may register at its entry point the current error  
handler for a  
communicator, set its own private error handler for this communicator, and  
restore before exiting the previous error handler.  
<P> 
    
      
      
      
      
     MPI_ERRHANDLER_FREE( errhandler )  
     
<BR> 
[  IN   errhandler] MPI error handler (handle)  
<BR> 
  
<P> 
 <tt> int MPI_Errhandler_free(MPI_Errhandler *errhandler) <BR></tt>  
<P> 
 <tt> MPI_ERRHANDLER_FREE(ERRHANDLER, IERROR)<BR> INTEGER ERRHANDLER, IERROR <BR></tt>  
Marks the error handler associated with  errhandler for  
deallocation and sets  errhandler to  
 MPI_ERRHANDLER_NULL.  
The error handler will be deallocated after  
all communicators associated with it have been deallocated.  
<P> 
    
      
      
      
      
     MPI_ERROR_STRING( errorcode, string, resultlen )  
     
<BR> 
[  IN   errorcode] Error code returned by an MPI routine  
 
<BR> 
[  OUT   string] Text that corresponds to the  errorcode  
 
<BR> 
[  OUT   resultlen] Length (in printable characters) of the  
result returned in  string  
<BR> 
  
<P> 
 <tt> int MPI_Error_string(int errorcode, char *string, int *resultlen) <BR></tt>  
<P> 
 <tt> MPI_ERROR_STRING(ERRORCODE, STRING, RESULTLEN, IERROR)<BR> INTEGER ERRORCODE, RESULTLEN, IERROR <BR>CHARACTER*(*) STRING <BR></tt>  
<P> 
Returns the error string associated with an error code  
  
or class.  
  
The argument  string must represent storage that is at least  
 MPI_MAX_ERROR_STRING characters long.  
<P> 
The number of characters actually written  
is returned in the output argument,  resultlen.  
<P> 
 
<BR> 
[]<em> Rationale.</em>  
<P> 
The form of this function was chosen to make the Fortran and C  
bindings similar.  A version that returns a pointer to a string has two  
difficulties.  First, the return string must be statically allocated and  
different for each error message (allowing the pointers returned by  
successive calls to  MPI_ERROR_STRING to point to the correct  
message).  Second, in Fortran, a function declared as returning  
 CHARACTER*(*) can not be referenced in, for example, a  
 PRINT statement.  
 (<em> End of rationale.</em>) <BR> 

<P>
<HR>
<A HREF="node143.html#Node147"><IMG SRC="previous.gif"></A><A HREF="node141.html#Node141"><IMG SRC="up.gif"></A><A HREF="node149.html#Node149"><IMG SRC="next.gif"></A><BR>
<b>Up: </b><A HREF="node141.html#Node141"> MPI Environmental Management</a>
<b>Next: </b><A HREF="node149.html#Node149"> Error codes and classes</a>
<b>Previous: </b><A HREF="node143.html#Node147"> Clock synchronization</a>
<P>
<HR>
Return to <A HREF="node182.html">MPI 1.1 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/docs/mpi-20-html/node306.html">MPI-2 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>MPI-1.1 of June 12, 1995<BR>
HTML Generated on August 6, 1997
</FONT>
</BODY>
</HTML>
