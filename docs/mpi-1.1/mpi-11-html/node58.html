<HTML>
<!-- This file was generated by tohtml from pt2pt.tex -->
<TITLE>Commit and free</TITLE>
<BODY BGCOLOR="#FFFFFF">
<HR><H2><A NAME="Node58">3.12.4. Commit and free</a></H2>
<A HREF="node57.html#Node57"><IMG SRC="previous.gif"></A><A HREF="node54.html#Node54"><IMG SRC="up.gif"></A><A HREF="node59.html#Node59"><IMG SRC="next.gif"></A><BR>
<b>Up: </b><A HREF="node54.html#Node54"> Derived datatypes</a>
<b>Next: </b><A HREF="node59.html#Node59"> Use of general datatypes in communication</a>
<b>Previous: </b><A HREF="node57.html#Node57"> Lower-bound and upper-bound markers</a>
<P>
  
<P> 
A datatype object has to be <b> committed</b> before it can be used in a  
communication.  
A committed datatype can still be used as a argument in datatype constructors.  
There is no need to commit basic datatypes. They are ``pre-committed.''  
<P> 
    
      
      
      
      
     MPI_TYPE_COMMIT(datatype)  
     
<BR> 
[  INOUT   datatype] datatype that is committed (handle)  
<BR> 
  
<P> 
 <tt> int MPI_Type_commit(MPI_Datatype *datatype) <BR></tt>  
<P> 
 <tt> MPI_TYPE_COMMIT(DATATYPE, IERROR)<BR> INTEGER  DATATYPE, IERROR <BR></tt>  
<P> 
The commit operation commits the datatype, that is, the formal description of  
a communication buffer, not the content of that buffer.  Thus, after a datatype  
has been committed, it can be repeatedly reused to communicate the changing  
content  
of a buffer or, indeed, the content of different buffers, with different  
starting addresses.  
<P> 
 
<BR> 
[]<em> Advice  
 to implementors.</em>  
<P> 
The system may ``compile'' at commit time an internal  
representation for the datatype that facilitates  
communication, e.g.  
change from a compacted representation to a flat representation of the  
datatype, and select the most convenient transfer mechanism.  
 (<em> End of advice to implementors.</em>) <BR> 
    
      
      
      
      
     MPI_TYPE_FREE(datatype)  
     
<BR> 
[  INOUT   datatype] datatype that is freed (handle)  
<BR> 
  
<P> 
 <tt> int MPI_Type_free(MPI_Datatype *datatype) <BR></tt>  
<P> 
 <tt> MPI_TYPE_FREE(DATATYPE, IERROR)<BR> INTEGER  DATATYPE, IERROR <BR></tt>  
<P> 
Marks the datatype object associated with  datatype for  
deallocation and sets  datatype to  MPI_DATATYPE_NULL.  
Any communication that is currently using this datatype will complete normally.  
Derived datatypes that were defined from the freed datatype are not  
affected.  
<P> 
<BR><b> Example</b>   
  
The following code fragment gives examples of using  
 MPI_TYPE_COMMIT.  
<BR> 
<pre><tt>INTEGER type1, type2 
CALL MPI_TYPE_CONTIGUOUS(5, MPI_REAL, type1, ierr) 
              ! new type object created 
CALL MPI_TYPE_COMMIT(type1, ierr) 
              ! now type1 can be used for communication 
type2 = type1 
              ! type2 can be used for communication 
              ! (it is a handle to same object as type1) 
CALL MPI_TYPE_VECTOR(3, 5, 4, MPI_REAL, type1, ierr) 
              ! new uncommitted type object created 
CALL MPI_TYPE_COMMIT(type1, ierr) 
              ! now type1 can be used anew for communication 
</tt></pre> 
   
<P> 
Freeing a datatype does not affect any other datatype that was  
built from the freed datatype.  The system behaves as if  
input datatype arguments to derived datatype constructors are passed by value.  
<P> 
 
<BR> 
[]<em> Advice  
 to implementors.</em>  
<P> 
The implementation may keep a reference count of active communications  
that use the datatype, in order to decide when to free it.  
Also, one may implement constructors of derived datatypes so that they keep  
pointers to their datatype arguments, rather then copying them.  In this  
case, one needs to keep track of active datatype definition references in order  
to know when a datatype object can be freed.  
 (<em> End of advice to implementors.</em>) <BR> 

<P>
<HR>
<A HREF="node57.html#Node57"><IMG SRC="previous.gif"></A><A HREF="node54.html#Node54"><IMG SRC="up.gif"></A><A HREF="node59.html#Node59"><IMG SRC="next.gif"></A><BR>
<b>Up: </b><A HREF="node54.html#Node54"> Derived datatypes</a>
<b>Next: </b><A HREF="node59.html#Node59"> Use of general datatypes in communication</a>
<b>Previous: </b><A HREF="node57.html#Node57"> Lower-bound and upper-bound markers</a>
<P>
<HR>
Return to <A HREF="node182.html">MPI 1.1 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/docs/mpi-20-html/node306.html">MPI-2 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>MPI-1.1 of June 12, 1995<BR>
HTML Generated on August 6, 1997
</FONT>
</BODY>
</HTML>
