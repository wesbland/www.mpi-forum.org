<HTML>
<!-- This file was generated by tohtml from topol.tex -->
<TITLE>Topology inquiry functions</TITLE>
<BODY BGCOLOR="#FFFFFF">
<HR><H2><A NAME="Node136">6.5.4. Topology inquiry functions</a></H2>
<A HREF="node135.html#Node135"><IMG SRC="previous.gif"></A><A HREF="node132.html#Node132"><IMG SRC="up.gif"></A><A HREF="node137.html#Node137"><IMG SRC="next.gif"></A><BR>
<b>Up: </b><A HREF="node132.html#Node132"> Topology Constructors</a>
<b>Next: </b><A HREF="node137.html#Node137"> Cartesian Shift Coordinates</a>
<b>Previous: </b><A HREF="node135.html#Node135"> General (Graph) Constructor</a>
<P>
  
<P> 
If a topology has been defined with one of the above functions, then the topology  
information can be looked up using inquiry functions. They all are local  
calls.  
<P> 
    
      
      
      
      
     MPI_TOPO_TEST(comm, status)  
     
<BR> 
[  IN    comm]  communicator (handle)  
 
<BR> 
[  OUT    status]  topology type of communicator <tt> comm</tt> (choice)  
<BR> 
  
<P> 
 <tt> int MPI_Topo_test(MPI_Comm comm, int *status) <BR></tt>  
<P> 
 <tt> MPI_TOPO_TEST(COMM, STATUS, IERROR)<BR> INTEGER COMM, STATUS, IERROR <BR></tt>  
<P> 
The function  MPI_TOPO_TEST returns the type of topology that  
is assigned to a communicator.  
<P> 
The output value <tt> status</tt> is one of the following:  
    
      
      
     
<BR> 
[ MPI_GRAPH] graph topology  
 
<BR> 
[ MPI_CART] cartesian topology  
 
<BR> 
[ MPI_UNDEFINED] no topology  
<BR> 
  
<P> 
    
      
      
      
      
     MPI_GRAPHDIMS_GET(comm, nnodes, nedges)  
     
<BR> 
[  IN    comm]  communicator for group with graph structure (handle)  
 
<BR> 
[  OUT    nnodes]  number of nodes in graph (integer) (same as number of processes in the group)  
 
<BR> 
[  OUT    nedges]  number of edges in graph (integer)  
<BR> 
  
<P> 
 <tt> int MPI_Graphdims_get(MPI_Comm comm, int *nnodes, int *nedges) <BR></tt>  
<P> 
 <tt> MPI_GRAPHDIMS_GET(COMM, NNODES, NEDGES, IERROR)<BR> INTEGER COMM, NNODES, NEDGES, IERROR <BR></tt>  
<P> 
Functions  MPI_GRAPHDIMS_GET and  
 MPI_GRAPH_GET retrieve the graph-topology information  
that was associated with a communicator by  
 MPI_GRAPH_CREATE.  
<P> 
The information provided by  MPI_GRAPHDIMS_GET can be used  
to dimension the  
vectors <tt> index</tt> and <tt> edges</tt> correctly for the following call  
to  MPI_GRAPH_GET.  
<P> 
    
      
      
      
      
     MPI_GRAPH_GET(comm, maxindex, maxedges, index, edges)  
     
<BR> 
[  IN    comm]  communicator with graph structure (handle)  
 
<BR> 
[  IN    maxindex]  length of vector  index in the calling program <BR>(integer)  
 
<BR> 
[  IN    maxedges]  length of vector  edges in the calling program <BR>(integer)  
 
<BR> 
[  OUT    index]  array of integers containing the graph structure (for details see the definition of  MPI_GRAPH_CREATE)  
 
<BR> 
[  OUT    edges]  array of integers containing the graph structure   
<BR> 
  
<P> 
 <tt> int MPI_Graph_get(MPI_Comm comm, int maxindex, int maxedges, int *index, int *edges) <BR></tt>  
<P> 
 <tt> MPI_GRAPH_GET(COMM, MAXINDEX, MAXEDGES, INDEX, EDGES, IERROR)<BR> INTEGER COMM, MAXINDEX, MAXEDGES, INDEX(*), EDGES(*), IERROR <BR></tt>  
<P> 
    
      
      
      
      
     MPI_CARTDIM_GET(comm, ndims)  
     
<BR> 
[  IN    comm]  communicator with cartesian structure (handle)  
 
<BR> 
[  OUT    ndims]  number of dimensions of the cartesian structure (integer)  
<BR> 
  
<P> 
 <tt> int MPI_Cartdim_get(MPI_Comm comm, int *ndims) <BR></tt>  
<P> 
 <tt> MPI_CARTDIM_GET(COMM, NDIMS, IERROR)<BR> INTEGER COMM, NDIMS, IERROR <BR></tt>  
<P> 
The functions  MPI_CARTDIM_GET and  
 MPI_CART_GET return the cartesian topology information that was  
associated with a communicator by  
 MPI_CART_CREATE.  
<P> 
    
      
      
      
      
     MPI_CART_GET(comm, maxdims, dims, periods, coords)  
     
<BR> 
[  IN    comm]  communicator with cartesian structure (handle)  
 
<BR> 
[  IN    maxdims]  length of vectors <tt> dims, periods</tt>, and <tt> coords</tt> in the calling program (integer)  
 
<BR> 
[  OUT    dims]  number of processes for each cartesian dimension (array of integer)  
 
<BR> 
[  OUT    periods]  periodicity ( true/ false) for each cartesian dimension (array of logical)  
 
<BR> 
[  OUT    coords]  coordinates of calling process in cartesian structure (array of integer)  
<BR> 
  
<P> 
 <tt> int MPI_Cart_get(MPI_Comm comm, int maxdims, int *dims, int *periods, int *coords) <BR></tt>  
<P> 
 <tt> MPI_CART_GET(COMM, MAXDIMS, DIMS, PERIODS, COORDS, IERROR)<BR> INTEGER COMM, MAXDIMS, DIMS(*), COORDS(*), IERROR <BR>LOGICAL PERIODS(*) <BR></tt>  
<P> 
<P> 
    
      
      
      
      
     MPI_CART_RANK(comm, coords, rank)  
     
<BR> 
[  IN    comm]  communicator with cartesian structure (handle)  
 
<BR> 
[  IN    coords]  integer array (of size <tt> ndims</tt>) specifying the cartesian coordinates of a process   
 
<BR> 
[  OUT    rank]  rank of specified process (integer)  
<BR> 
  
<P> 
 <tt> int MPI_Cart_rank(MPI_Comm comm, int *coords, int *rank) <BR></tt>  
<P> 
 <tt> MPI_CART_RANK(COMM, COORDS, RANK, IERROR)<BR> INTEGER COMM, COORDS(*), RANK, IERROR <BR></tt>  
<P> 
For a process group with cartesian structure, the function  
 MPI_CART_RANK translates the logical process coordinates to process  
ranks as they are used by the point-to-point routines.  
<P> 
For dimension <tt> i</tt> with <tt> periods(i) = true</tt>, if the coordinate,  
<tt> coords(i)</tt>, is out of range, that is, <tt> coords(i) <I>&lt;</i> 0</tt> or  
<tt> coords(i) <IMG SRC="img179.gif">
 dims(i)</tt>, it is shifted back to the interval  
<BR>  
<tt> 0 <IMG SRC="img180.gif">
 coords(i) <I>&lt;</i> dims(i)</tt> automatically. Out-of-range  
coordinates are erroneous for non-periodic dimensions.  
<P> 
    
      
      
      
      
     MPI_CART_COORDS(comm, rank, maxdims, coords)  
     
<BR> 
[  IN    comm]  communicator with cartesian structure (handle)  
 
<BR> 
[  IN    rank]  rank of a process within group of  comm (integer)  
 
<BR> 
[  IN    maxdims]  length of vector <tt> coord</tt> in the calling program (integer)  
 
<BR> 
[  OUT    coords]  integer array (of size <tt> ndims</tt>) containing the cartesian coordinates of specified process (integer)  
<BR> 
  
<P> 
 <tt> int MPI_Cart_coords(MPI_Comm comm, int rank, int maxdims, int *coords) <BR></tt>  
<P> 
 <tt> MPI_CART_COORDS(COMM, RANK, MAXDIMS, COORDS, IERROR)<BR> INTEGER COMM, RANK, MAXDIMS, COORDS(*), IERROR <BR></tt>  
<P> 
The inverse mapping, rank-to-coordinates translation is provided by  
 MPI_CART_COORDS.  
    
      
      
      
      
     MPI_GRAPH_NEIGHBORS_COUNT(comm, rank, nneighbors)  
     
<BR> 
[  IN    comm]  communicator with graph topology (handle)  
 
<BR> 
[  IN    rank]  rank of process in group of  comm (integer)  
 
<BR> 
[  OUT    nneighbors]  number of neighbors of specified process (integer)  
<BR> 
  
<P> 
 <tt> int MPI_Graph_neighbors_count(MPI_Comm comm, int rank, int *nneighbors) <BR></tt>  
<P> 
 <tt> MPI_GRAPH_NEIGHBORS_COUNT(COMM, RANK, NNEIGHBORS, IERROR)<BR> INTEGER COMM, RANK, NNEIGHBORS, IERROR <BR></tt>  
<P> 
 MPI_GRAPH_NEIGHBORS_COUNT and  MPI_GRAPH_NEIGHBORS provide  
adjacency information for a general, graph topology.  
<P> 
    
      
      
      
      
     MPI_GRAPH_NEIGHBORS(comm, rank, maxneighbors, neighbors)  
     
<BR> 
[  IN    comm]  communicator with graph topology (handle)  
 
<BR> 
[  IN    rank]  rank of process in group of  comm (integer)  
 
<BR> 
[  IN    maxneighbors]  size of array  neighbors (integer)  
 
<BR> 
[  OUT    neighbors]  ranks of processes that are neighbors to specified process (array of integer)  
<BR> 
  
<P> 
 <tt> int MPI_Graph_neighbors(MPI_Comm comm, int rank, int maxneighbors, int *neighbors) <BR></tt>  
<P> 
 <tt> MPI_GRAPH_NEIGHBORS(COMM, RANK, MAXNEIGHBORS, NEIGHBORS, IERROR)<BR> INTEGER COMM, RANK, MAXNEIGHBORS, NEIGHBORS(*), IERROR <BR></tt>  
<P> 
<BR><b> Example</b>    
  
<P> 
Suppose that <tt> comm</tt> is a communicator with a  
shuffle-exchange topology.   The group has <I>2<SUP>n</SUP></i> members.  
Each process is labeled by <IMG SRC="img181.gif">
 with <IMG SRC="img182.gif">
, and has three neighbors:  
exchange(<IMG SRC="img183.gif">
  
(<IMG SRC="img184.gif">
), shuffle(<IMG SRC="img185.gif">
, and unshuffle(<IMG SRC="img186.gif">
.  
The graph adjacency list is illustrated below for <I>n=3</i>.  
<BR>  
<P><IMG SRC="img187.gif"><P>
  
Suppose that the communicator <tt> comm</tt> has this topology associated with it.  
The following code fragment cycles through the three types of neighbors  
and performs an appropriate permutation for each.  
<P> 
<BR> 
<pre><tt>C  assume: each process has stored a real number A. 
C  extract neighborhood information 
      CALL MPI_COMM_RANK(comm, myrank, ierr) 
      CALL MPI_GRAPH_NEIGHBORS(comm, myrank, 3, neighbors, ierr) 
C  perform exchange permutation 
      CALL MPI_SENDRECV_REPLACE(A, 1, MPI_REAL, neighbors(1), 0, 
     +     neighbors(1), 0, comm, status, ierr) 
C  perform shuffle permutation 
      CALL MPI_SENDRECV_REPLACE(A, 1, MPI_REAL, neighbors(2), 0, 
     +     neighbors(3), 0, comm, status, ierr) 
C  perform unshuffle permutation 
      CALL MPI_SENDRECV_REPLACE(A, 1, MPI_REAL, neighbors(3), 0, 
     +     neighbors(2), 0, comm, status, ierr) 
</tt></pre> 
   
<P> 

<P>
<HR>
<A HREF="node135.html#Node135"><IMG SRC="previous.gif"></A><A HREF="node132.html#Node132"><IMG SRC="up.gif"></A><A HREF="node137.html#Node137"><IMG SRC="next.gif"></A><BR>
<b>Up: </b><A HREF="node132.html#Node132"> Topology Constructors</a>
<b>Next: </b><A HREF="node137.html#Node137"> Cartesian Shift Coordinates</a>
<b>Previous: </b><A HREF="node135.html#Node135"> General (Graph) Constructor</a>
<P>
<HR>
Return to <A HREF="node182.html">MPI 1.1 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/docs/mpi-20-html/node306.html">MPI-2 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>MPI-1.1 of June 12, 1995<BR>
HTML Generated on August 6, 1997
</FONT>
</BODY>
</HTML>
