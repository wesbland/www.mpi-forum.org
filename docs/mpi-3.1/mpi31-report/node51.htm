<!DOCTYPE html>
<html lang=en>
<head>
<!-- This file was generated by tohtml from chap-pt2pt/pt2pt.tex -->
<!-- with the command
tohtml -default -basedef mpi3defs.txt -numbers -indexname myindex -dosnl -htables -quietlatex -allgif -endpage mpi3-forum-tail.htm -Wnoredef -o mpi31-report.tex mpi-report.tex 
-->
<title>Return Status</title>
</head>
<body style="background-color:#FFFFFF">
<hr><h2><span id="Node51">47. Return Status</span></h2>
<a href="node50.htm#Node50"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node46.htm#Node46"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node52.htm#Node52"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node46.htm#Node46"> Blocking Send and Receive Operations</a>
<b>Next: </b><a href="node52.htm#Node52"> Passing <font face="sans-serif">  MPI_STATUS_IGNORE</font> for Status</a>
<b>Previous: </b><a href="node50.htm#Node50"> Blocking Receive</a>
<p>
  
  
<P> 
The source or tag of a received message may not be known if wildcard  
values were used in the receive operation.  
Also, if multiple requests  
are completed by a single <font face="sans-serif"> MPI</font> function (see  
Section <a href="node66.htm#Node66">Multiple Completions 
</a>), a distinct error code may need to be  
returned for each request.  
The information is returned by the <font face="sans-serif"> status</font>  
argument of <font face="sans-serif"> MPI_RECV</font>.  The type of <font face="sans-serif"> status</font> is  
<font face="sans-serif"> MPI</font>-defined.  
Status variables need to be explicitly  
allocated by the user, that is, they are not system objects.  
<P> 
In C, <font face="sans-serif"> status</font> is a structure that contains three fields named  
<font face="sans-serif">  MPI_SOURCE</font>, <font face="sans-serif">  MPI_TAG</font>, and <font face="sans-serif">  MPI_ERROR</font>; the  
structure may contain additional fields.  Thus, <font face="sans-serif"> status.MPI_SOURCE</font>,  
<font face="sans-serif"> status.MPI_TAG</font> and <font face="sans-serif"> status.MPI_ERROR</font> contain the  
source, tag, and error code, respectively, of  
the received message.  
<P> 
In Fortran with <tt>USE</tt> <tt>mpi</tt> or <tt>INCLUDE</tt> <tt>'mpif.h'</tt>,   
<font face="sans-serif"> status</font> is an array of <tt> INTEGER</tt>s of size  
<font face="sans-serif">  MPI_STATUS_SIZE</font>.  The constants <font face="sans-serif">  MPI_SOURCE</font>,  
<font face="sans-serif">  MPI_TAG</font> and <font face="sans-serif">  MPI_ERROR</font>  
are the indices of the entries that store the  
source, tag and error fields.  Thus, <font face="sans-serif"> status(MPI_SOURCE)</font>,  
<font face="sans-serif"> status(MPI_TAG)</font> and <font face="sans-serif"> status(MPI_ERROR)</font>  
contain, respectively, the source,  
tag and error code of the received message.  
 <P> 
With Fortran <tt>USE</tt> <tt>mpi_f08</tt>, status is defined as the  
Fortran <tt> BIND(C)</tt> derived type <tt> TYPE(MPI_Status)</tt>   
containing three public <tt> INTEGER</tt> fields named <font face="sans-serif">  MPI_SOURCE</font>,  
<font face="sans-serif">  MPI_TAG</font>, and <font face="sans-serif">  MPI_ERROR</font>.   
<tt> TYPE(MPI_Status)</tt> may contain additional, implementation-specific fields.  
Thus, <tt>status%MPI_SOURCE</tt>, <tt>status%MPI_TAG</tt>   
and <tt>status%MPI_ERROR</tt> contain the source,  
tag, and error code of a received message respectively.  
Additionally, within both the <tt>mpi</tt> and the <tt>mpi_f08</tt> modules,  
the constants <font face="sans-serif">  MPI_STATUS_SIZE</font>,   
<font face="sans-serif">  MPI_SOURCE</font>, <font face="sans-serif">  MPI_TAG</font>, <font face="sans-serif">  MPI_ERROR</font>,  
and <tt> TYPE(MPI_Status)</tt>  
are defined to allow conversion between both status representations.  
Conversion routines are provided in   
Section <a href="node447.htm#Node447">Status 
</a>.  
<P> 
 
<br> 
<em> Rationale.</em>  
<P> 
The Fortran <tt> TYPE(MPI_Status)</tt>   
is defined as a <tt> BIND(C)</tt> derived type  
so that it can be used at any location where  
the status integer array representation can be used,  
e.g., in user defined common blocks.   
 (<em> End of rationale.</em>) <br> 
 
<br> 
<em> Rationale.</em>  
<P> 
It is allowed to have the same name (e.g., <font face="sans-serif">  MPI_SOURCE</font>)  
defined as a constant (e.g., Fortran parameter) and as a field  
of a derived type.  
 (<em> End of rationale.</em>) <br> 
  
  
  
  
  
  
<P> 
In general, message-passing calls do not modify the value of the error  
code field of status variables.  This field may be updated only by  
the functions in Section <a href="node66.htm#Node66">Multiple Completions 
</a> which return multiple  
statuses.  The field is updated if and only if such function returns with  
an error code of <font face="sans-serif">  MPI_ERR_IN_STATUS</font>.  
<P> 
 
<br> 
<em> Rationale.</em>  
<P> 
The error field in status is not needed for calls that return only one  
status, such as <font face="sans-serif"> MPI_WAIT</font>, since that would only duplicate the  
information returned by the function itself.  The current design  
avoids the additional overhead of setting it, in such cases.  The field  
is needed for calls that return multiple statuses, since each request  
may have had a different failure.  
 (<em> End of rationale.</em>) <br> 
The status argument also returns information on the length of the message  
received.  However, this information is not directly available as a field  
of the status variable and a call to <font face="sans-serif"> MPI_GET_COUNT</font> is required  
to ``decode'' this information.  
<P> 
<TABLE><TR><TD COLSPAN=2>MPI_GET_COUNT(status, datatype, count)</TD></TR>  
<TR><TD> IN status</TD><TD>return status of receive operation (Status)</TD></TR>  
<TR><TD> IN datatype</TD><TD>datatype of each receive buffer entry (handle)</TD></TR>  
<TR><TD> OUT count</TD><TD>number of received entries (integer)</TD></TR>  
</TABLE>  
<P> 
 <tt> int MPI_Get_count(const MPI_Status *status, MPI_Datatype datatype, int *count) <br></tt>  
<P> 
 <tt> MPI_Get_count(status, datatype, count, ierror) <br> TYPE(MPI_Status), INTENT(IN) :: status <br>TYPE(MPI_Datatype), INTENT(IN) :: datatype <br>INTEGER, INTENT(OUT) :: count <br>INTEGER, OPTIONAL, INTENT(OUT) :: ierror <br></tt>  
 <tt> MPI_GET_COUNT(STATUS, DATATYPE, COUNT, IERROR)<br> INTEGER  STATUS(MPI_STATUS_SIZE), DATATYPE, COUNT, IERROR <br></tt>  
  
<P> 
Returns the number of entries received.  (Again, we count <em> entries</em>, each of  
type <em> datatype</em>, not <em> bytes</em>.)  
The <font face="sans-serif"> datatype</font> argument should match  
the argument provided by the receive call that set the <font face="sans-serif"> status</font> variable.  
If the number of entries received exceeds the limits of the <font face="sans-serif"> count</font>  
parameter, then <font face="sans-serif"> MPI_GET_COUNT</font> sets the value of <font face="sans-serif"> count</font> to  
<font face="sans-serif">  MPI_UNDEFINED</font>.  
There are other situations where the value of  
<font face="sans-serif"> count</font> can be set to <font face="sans-serif">  MPI_UNDEFINED</font>; see Section <a href="node88.htm#Node88">Use of General Datatypes in Communication 
</a>.  
<P> 
 
<br> 
<em> Rationale.</em>  
<P> 
Some message-passing libraries use <font face="sans-serif">  INOUT</font> <font face="sans-serif"> count</font>,  
<font face="sans-serif"> tag</font> and <font face="sans-serif"> source</font> arguments, thus using them both to specify  
the selection criteria for incoming messages and return the actual envelope  
values of the received message.  
The use of a separate status argument prevents errors that are often attached  
with <font face="sans-serif">  INOUT</font> argument (e.g., using the  
<font face="sans-serif">  MPI_ANY_TAG</font> constant as  
the tag in a receive).  
Some libraries use calls that refer implicitly to the ``last message  
received.''  This is not thread safe.  
<P> 
The <font face="sans-serif"> datatype</font> argument is passed to <font face="sans-serif"> MPI_GET_COUNT</font> so as to  
improve performance. A message might be received without counting the number  
of elements it contains, and the count value is often not needed.  
Also, this allows the same function to be used after a call to  
<font face="sans-serif"> MPI_PROBE</font> or <font face="sans-serif"> MPI_IPROBE</font>. With a status from <font face="sans-serif"> MPI_PROBE</font> or <font face="sans-serif"> MPI_IPROBE</font>,  
the same datatypes are allowed as in a call to <font face="sans-serif"> MPI_RECV</font> to receive this message.  
 (<em> End of rationale.</em>) <br> 
The value returned as the <font face="sans-serif"> count</font> argument of  
<font face="sans-serif"> MPI_GET_COUNT</font> for a datatype of length zero where zero bytes  
have been transferred is zero.  If the number of bytes transferred is  
greater than zero, <font face="sans-serif">  MPI_UNDEFINED</font> is returned.  
<P> 
 
<br> 
<em> Rationale.</em>  
<P> 
Zero-length datatypes may be created in a number of cases.    
An important case is  
<font face="sans-serif"> MPI_TYPE_CREATE_DARRAY</font>, where the  
definition of the particular   
darray   
results in an empty block on some  
<font face="sans-serif"> MPI</font> process.  Programs written in an SPMD style will not check for  
this special case and may want to use <font face="sans-serif"> MPI_GET_COUNT</font> to check  
the status.    
 (<em> End of rationale.</em>) <br> 
 
<br> 
<em> Advice to users.</em>  
<P> 
The buffer size required for the receive can be affected by data conversions and  
by the stride of the receive datatype.  
In most cases, the safest approach is to use the same datatype with <font face="sans-serif"> MPI_GET_COUNT</font> and the receive.  
 (<em> End of advice to users.</em>) <br> 
All send and receive operations use the <font face="sans-serif"> buf</font>, <font face="sans-serif"> count</font>,<font face="sans-serif">   
datatype</font>, <font face="sans-serif"> source</font>, <font face="sans-serif"> dest</font>, <font face="sans-serif"> tag</font>,  
<font face="sans-serif"> comm</font>, and <font face="sans-serif"> status</font> arguments in the same way as the blocking  
<font face="sans-serif"> MPI_SEND</font> and  
<font face="sans-serif"> MPI_RECV</font> operations described in this section.  
<P> 

<P>
<hr>
<a href="node50.htm#Node50"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node46.htm#Node46"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node52.htm#Node52"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node46.htm#Node46"> Blocking Send and Receive Operations</a>
<b>Next: </b><a href="node52.htm#Node52"> Passing <font face="sans-serif">  MPI_STATUS_IGNORE</font> for Status</a>
<b>Previous: </b><a href="node50.htm#Node50"> Blocking Receive</a>
<p>
<HR>
Return to <A HREF="node523.htm">MPI-3.1 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-3.1 of June 4, 2015<BR>
HTML Generated on June 4, 2015
</FONT>
</body>
</html>
