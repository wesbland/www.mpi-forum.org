<!DOCTYPE html>
<html lang=en>
<head>
<!-- This file was generated by tohtml from chap-inquiry/inquiry.tex -->
<!-- with the command
tohtml -default -basedef mpi3defs.txt -numbers -indexname myindex -dosnl -htables -quietlatex -allgif -endpage mpi3-forum-tail.htm -Wnoredef -o mpi31-report.tex mpi-report.tex 
-->
<title>Error Classes, Error Codes, and Error Handlers</title>
</head>
<body style="background-color:#FFFFFF">
<hr><h1><span id="Node223">206. Error Classes, Error Codes, and Error Handlers</span></h1>
<a href="node222.htm#Node222"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="mpi31-report.htm#Node0"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node224.htm#Node224"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="mpi31-report.htm#Node0">Contents</a>
<b>Next: </b><a href="node224.htm#Node224"> Timers and Synchronization</a>
<b>Previous: </b><a href="node222.htm#Node222"> Error Codes and Classes</a>
<p>
  
  
  
<P> 
Users may want to write a layered library on top of an existing <font face="sans-serif"> MPI</font>  
implementation, and this library may have its own set of error codes  
and classes. An example of such a library is an I/O library based on  
<font face="sans-serif"> MPI</font>, see Chapter <a href="node304.htm#Node304">I/O 
</a>.  
For this purpose, functions are needed to:  
<ol> 
 
1. add a new error class to the ones an <font face="sans-serif"> MPI</font> implementation already  
knows.  
 
<br> 
2. associate error codes with this error class, so that  
<font face="sans-serif"> MPI_ERROR_CLASS</font> works.   
 
<br> 
3. associate strings with these error codes, so that  
<font face="sans-serif"> MPI_ERROR_STRING</font> works.   
 
<br> 
4. invoke the error handler associated with a communicator, window, or  
object.  
</ol> 
  
Several   
functions are provided to do this.  They are all local.  
No functions are provided to free   
error classes or codes: it  
is not expected that an application will generate them in significant  
numbers.  
<P> 
<TABLE><TR><TD COLSPAN=2>MPI_ADD_ERROR_CLASS(errorclass)</TD></TR>  
<TR><TD> OUT errorclass</TD><TD>value for the new error class (integer)</TD></TR>  
</TABLE>  
<P> 
 <tt> int MPI_Add_error_class(int *errorclass) <br></tt>  
<P> 
 <tt> MPI_Add_error_class(errorclass, ierror) <br> INTEGER, INTENT(OUT) :: errorclass <br>INTEGER, OPTIONAL, INTENT(OUT) :: ierror <br></tt>  
 <tt> MPI_ADD_ERROR_CLASS(ERRORCLASS, IERROR)<br> INTEGER ERRORCLASS, IERROR <br></tt>  
<P> 
  
<P> 
Creates a new error class and returns the value for it.  
<P> 
 
<br> 
<em> Rationale.</em>  
<P> 
To avoid conflicts with existing error codes and classes, the value is  
set by the implementation and not by the user.  
 (<em> End of rationale.</em>) <br> 
 
<br> 
<em> Advice  
        to implementors.</em>  
<P> 
A high-quality implementation will return the value for a new  
<font face="sans-serif"> errorclass</font> in the same deterministic way on all processes.  
 (<em> End of advice to implementors.</em>) <br> 
 
<br> 
<em> Advice to users.</em>  
<P> 
Since a call to <font face="sans-serif"> MPI_ADD_ERROR_CLASS</font> is local, the same  
<font face="sans-serif"> errorclass</font> may not be returned on all processes that make  
this call.  Thus, it is not safe to assume that registering a new  
error on a set of processes at the same time will yield the same  
<font face="sans-serif"> errorclass</font> on all of the processes.  However,  if an  
implementation returns the new <font face="sans-serif"> errorclass</font> in a deterministic  
way, and they are always generated in the same order  
on the same set of processes (for  
example, all processes), then the value will be the same.  However,  
even if a deterministic algorithm is used, the value can vary across  
processes.  This can happen, for example, if different but overlapping  
groups of processes make a series of calls.  As a result of these issues,  
getting the ``same'' error on multiple processes may not cause the  
same value of error code to be generated.  
 (<em> End of advice to users.</em>) <br> 
The value of <font face="sans-serif">  MPI_ERR_LASTCODE</font>  
is a constant value and   
is not affected by new user-defined  
error codes and classes.    
Instead, a predefined attribute key <font face="sans-serif">  MPI_LASTUSEDCODE</font> is  
associated with  
<font face="sans-serif">  MPI_COMM_WORLD</font>.  The attribute value corresponding to this key  
is the current maximum error class including the user-defined ones.  
This is a local value and may be different on different processes.    
The value returned by this key is always greater than or equal to  
<font face="sans-serif">  MPI_ERR_LASTCODE</font>.  
<P> 
 
<br> 
<em> Advice to users.</em>  
<P> 
The value returned by the key  
<font face="sans-serif">  MPI_LASTUSEDCODE</font> will not change unless the user calls a  
function to explicitly add an error class/code.  In a multi-threaded  
environment, the user must take extra care in assuming this value has  
not changed.  
Note that error codes and error classes are not necessarily dense.  A user may not assume that each error class below <font face="sans-serif">  MPI_LASTUSEDCODE</font> is valid.  
 (<em> End of advice to users.</em>) <br> 
<TABLE><TR><TD COLSPAN=2>MPI_ADD_ERROR_CODE(errorclass, errorcode)</TD></TR>  
<TR><TD> IN errorclass</TD><TD>error class (integer)</TD></TR>  
<TR><TD> OUT errorcode</TD><TD>new error code to associated with <font face="sans-serif"> errorclass</font> (integer)</TD></TR>  
</TABLE>  
<P> 
 <tt> int MPI_Add_error_code(int errorclass, int *errorcode) <br></tt>  
<P> 
 <tt> MPI_Add_error_code(errorclass, errorcode, ierror) <br> INTEGER, INTENT(IN) :: errorclass <br>INTEGER, INTENT(OUT) :: errorcode <br>INTEGER, OPTIONAL, INTENT(OUT) :: ierror <br></tt>  
 <tt> MPI_ADD_ERROR_CODE(ERRORCLASS, ERRORCODE, IERROR)<br> INTEGER ERRORCLASS, ERRORCODE, IERROR <br></tt>  
<P> 
  
<P> 
Creates new error code associated with  
<font face="sans-serif"> errorclass</font> and returns its value in <font face="sans-serif"> errorcode</font>.  
<P> 
 
<br> 
<em> Rationale.</em>  
<P> 
To avoid conflicts with existing error codes and classes, the value  
of the new error code is set by the implementation and not by the  
user.   
 (<em> End of rationale.</em>) <br> 
 
<br> 
<em> Advice  
        to implementors.</em>  
<P> 
A high-quality implementation will return the value for a new  
<font face="sans-serif"> errorcode</font> in the same deterministic way on all processes.  
 (<em> End of advice to implementors.</em>) <br> 
<TABLE><TR><TD COLSPAN=2>MPI_ADD_ERROR_STRING(errorcode, string)</TD></TR>  
<TR><TD> IN errorcode</TD><TD>error code or class (integer)</TD></TR>  
<TR><TD> IN string</TD><TD>text corresponding to <font face="sans-serif"> errorcode</font> (string)</TD></TR>  
</TABLE>  
<P> 
 <tt> int MPI_Add_error_string(int errorcode, const char *string) <br></tt>  
<P> 
 <tt> MPI_Add_error_string(errorcode, string, ierror) <br> INTEGER, INTENT(IN) :: errorcode <br>CHARACTER(LEN=*), INTENT(IN) :: string <br>INTEGER, OPTIONAL, INTENT(OUT) :: ierror <br></tt>  
 <tt> MPI_ADD_ERROR_STRING(ERRORCODE, STRING, IERROR)<br> INTEGER ERRORCODE, IERROR <br>CHARACTER*(*) STRING <br></tt>  
<P> 
  
<P> 
Associates an error string with an error code or class.  
The string must be no more than <font face="sans-serif">  MPI_MAX_ERROR_STRING</font>  
characters long.  The length of the string is as defined in the  
calling language.    
The length of the string does not include the null terminator in C.  
Trailing blanks will be stripped in Fortran.  
Calling <font face="sans-serif"> MPI_ADD_ERROR_STRING</font> for an <font face="sans-serif"> errorcode</font>  
that already has a string will replace the old string with the new  
string.  It is erroneous to call <font face="sans-serif"> MPI_ADD_ERROR_STRING</font> for  
an error code or class with a value <i>leq constiMPI_ERR_LASTCODE</i>.  
<P> 
If <font face="sans-serif"> MPI_ERROR_STRING</font> is called when no string has been set,  
it will return a empty string (all spaces in Fortran, <tt>""</tt> in C).  
<P> 
Section <a href="node217.htm#Node217">Error Handling 
</a> describes the methods for creating  
and associating error handlers with communicators, files, and windows.  
<P> 
<TABLE><TR><TD COLSPAN=2>MPI_COMM_CALL_ERRHANDLER (comm, errorcode)</TD></TR>  
<TR><TD> IN comm</TD><TD>communicator with error handler (handle)</TD></TR>  
<TR><TD> IN errorcode</TD><TD>error code (integer)</TD></TR>  
</TABLE>  
<P> 
 <tt> int MPI_Comm_call_errhandler(MPI_Comm comm, int errorcode) <br></tt>  
<P> 
 <tt> MPI_Comm_call_errhandler(comm, errorcode, ierror) <br> TYPE(MPI_Comm), INTENT(IN) :: comm <br>INTEGER, INTENT(IN) :: errorcode <br>INTEGER, OPTIONAL, INTENT(OUT) :: ierror <br></tt>  
 <tt> MPI_COMM_CALL_ERRHANDLER(COMM, ERRORCODE, IERROR)<br> INTEGER COMM, ERRORCODE, IERROR <br></tt>  
<P> 
  
<P> 
This function invokes the error handler assigned to the communicator  
with the error code supplied.    
This function returns <font face="sans-serif">  MPI_SUCCESS</font> in C and the same  
value in <font face="sans-serif"> IERROR</font> if the error handler was successfully called  
(assuming the process is not aborted and the error handler returns).  
<P> 
 
<br> 
<em> Advice to users.</em>  
<P> 
Users should note that the default error handler is  
<font face="sans-serif">  MPI_ERRORS_ARE_FATAL</font>.  Thus, calling  
<font face="sans-serif"> MPI_COMM_CALL_ERRHANDLER</font> will abort the <font face="sans-serif"> comm</font>  
processes if the default error handler has not been changed for this  
communicator or on the parent before the communicator was created.  
 (<em> End of advice to users.</em>) <br> 
<TABLE><TR><TD COLSPAN=2>MPI_WIN_CALL_ERRHANDLER (win, errorcode)</TD></TR>  
<TR><TD> IN win</TD><TD>window with error handler (handle)</TD></TR>  
<TR><TD> IN errorcode</TD><TD>error code (integer)</TD></TR>  
</TABLE>  
<P> 
 <tt> int MPI_Win_call_errhandler(MPI_Win win, int errorcode) <br></tt>  
<P> 
 <tt> MPI_Win_call_errhandler(win, errorcode, ierror) <br> TYPE(MPI_Win), INTENT(IN) :: win <br>INTEGER, INTENT(IN) :: errorcode <br>INTEGER, OPTIONAL, INTENT(OUT) :: ierror <br></tt>  
 <tt> MPI_WIN_CALL_ERRHANDLER(WIN, ERRORCODE, IERROR)<br> INTEGER WIN, ERRORCODE, IERROR <br></tt>  
<P> 
  
<P> 
This function invokes the error handler assigned to the window  
with the error code supplied.    
This function returns <font face="sans-serif">  MPI_SUCCESS</font> in C and the same  
value in <font face="sans-serif"> IERROR</font> if the error handler was successfully called  
(assuming the process is not aborted and the error handler returns).  
<P> 
 
<br> 
<em> Advice to users.</em>  
<P> 
As with communicators, the default error handler for windows is  
<font face="sans-serif">  MPI_ERRORS_ARE_FATAL</font>.  
 (<em> End of advice to users.</em>) <br> 
<TABLE><TR><TD COLSPAN=2>MPI_FILE_CALL_ERRHANDLER (fh, errorcode)</TD></TR>  
<TR><TD> IN fh</TD><TD>file with error handler (handle)</TD></TR>  
<TR><TD> IN errorcode</TD><TD>error code (integer)</TD></TR>  
</TABLE>  
<P> 
 <tt> int MPI_File_call_errhandler(MPI_File fh, int errorcode) <br></tt>  
<P> 
 <tt> MPI_File_call_errhandler(fh, errorcode, ierror) <br> TYPE(MPI_File), INTENT(IN) :: fh <br>INTEGER, INTENT(IN) :: errorcode <br>INTEGER, OPTIONAL, INTENT(OUT) :: ierror <br></tt>  
 <tt> MPI_FILE_CALL_ERRHANDLER(FH, ERRORCODE, IERROR)<br> INTEGER FH, ERRORCODE, IERROR <br></tt>  
<P> 
  
<P> 
This function invokes the error handler assigned to the file  
with the error code supplied.    
This function returns <font face="sans-serif">  MPI_SUCCESS</font> in C and the same  
value in <font face="sans-serif"> IERROR</font> if the error handler was successfully called  
(assuming the process is not aborted and the error handler returns).  
<P> 
 
<br> 
<em> Advice to users.</em>  
<P> 
Unlike errors on communicators and windows, the default behavior for files is to have  
<font face="sans-serif">  MPI_ERRORS_RETURN</font>.  
 (<em> End of advice to users.</em>) <br> 
 
<br> 
<em> Advice to users.</em>  
<P> 
Users are warned that handlers should not be called recursively with  
<font face="sans-serif"> MPI_COMM_CALL_ERRHANDLER</font>,  
<font face="sans-serif"> MPI_FILE_CALL_ERRHANDLER</font>, or  
<font face="sans-serif"> MPI_WIN_CALL_ERRHANDLER</font>.  Doing  
this can create a situation where an infinite recursion is created.  
This can occur if <font face="sans-serif"> MPI_COMM_CALL_ERRHANDLER</font>,  
<font face="sans-serif"> MPI_FILE_CALL_ERRHANDLER</font>, or  
<font face="sans-serif"> MPI_WIN_CALL_ERRHANDLER</font> is called  
inside an error handler.  
<P> 
Error codes and classes are associated with a process.  As a result,  
they may be used in any error handler.  Error handlers should be  
prepared to deal with any error code   
they are   
given.  Furthermore, it is  
good practice to only call an error handler with the appropriate  
error codes.  For example, file errors would normally be sent to the  
file error   
handler.  
 (<em> End of advice to users.</em>) <br> 

<P>
<hr>
<a href="node222.htm#Node222"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="mpi31-report.htm#Node0"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node224.htm#Node224"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="mpi31-report.htm#Node0">Contents</a>
<b>Next: </b><a href="node224.htm#Node224"> Timers and Synchronization</a>
<b>Previous: </b><a href="node222.htm#Node222"> Error Codes and Classes</a>
<p>
<HR>
Return to <A HREF="node523.htm">MPI-3.1 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-3.1 of June 4, 2015<BR>
HTML Generated on June 4, 2015
</FONT>
</body>
</html>
